import { computed, ref } from 'vue';
import {getRequest, postRequest} from '../http/index'

export const storeModuleFactory = (moduleName: string) => {
    const state = ref({});

    const getters = {
        // Met "all" kunnen we de gegevens als computed value uit de state halen,
        // wat voor reactiviteit tussen componenten en state zorgt.
        all: computed(() => Object.values(state.value))
    };

    const setters = {
        // met setAll() kunnen we data, wat uit de backEnd komt, in de state zetten op basis van id
        setAll: (items) => {
            items.forEach(item => {
                state.value[item.id] = item;
            });
        }
    };

    const actions = {
        getAll: async () => {
            // Simuleer een oproep naar een API, mbv de Axios facade
            const {data} = await getRequest(moduleName);
            if(!data) return
            setters.setAll(data);
        },
        astAll: async () => {
            // Simuleer een oproep naar een API, mbv de Axios facade
            const {data} = await postRequest(moduleName);
            if(!data) return
            setters.setAll(data);
        }
    };
    
    return {
        getters,
        actions
    };
}







